function amron_module(){function r(){this._device=function(){var a=window,b=a.navigator.userAgent,d={ios:!1,android:!1,androidChrome:!1,desktop:!1,windows:!1,iphone:!1,ipod:!1,ipad:!1,cordova:a.cordova||a.phonegap,phonegap:a.cordova||a.phonegap},e=b.match(/(Windows Phone);?[\s\/]+([\d.]+)?/),f=b.match(/(Android);?[\s\/]+([\d.]+)?/),m=b.match(/(iPad).*OS\s([\d_]+)/),g=b.match(/(iPod)(.*OS\s([\d_]+))?/),k=!m&&b.match(/(iPhone\sOS|iOS)\s([\d_]+)/);e&&(d.os="windows",d.osVersion=e[2],d.windows=!0);f&&
!e&&(d.os="android",d.osVersion=f[2],d.android=!0,d.androidChrome=0<=b.toLowerCase().indexOf("chrome"));if(m||k||g)d.os="ios",d.ios=!0;k&&!g&&(d.osVersion=k[2].replace(/_/g,"."),d.iphone=!0);m&&(d.osVersion=m[2].replace(/_/g,"."),d.ipad=!0);g&&(d.osVersion=g[3]?g[3].replace(/_/g,"."):null,d.iphone=!0);d.ios&&d.osVersion&&0<=b.indexOf("Version/")&&"10"===d.osVersion.split(".")[0]&&(d.osVersion=b.toLowerCase().split("version/")[1].split(" ")[0]);d.desktop=!(d.os||d.android||d.webView);d.webView=(k||
m||g)&&b.match(/.*AppleWebKit(?!.*Safari)/i);d.os&&"ios"===d.os&&(b=d.osVersion.split("."),e=document.querySelector('meta[name="viewport"]'),d.minimalUi=!d.webView&&(g||k)&&(7===1*b[0]?1<=1*b[1]:7<1*b[0])&&e&&0<=e.getAttribute("content").indexOf("minimal-ui"));d.pixelRatio=a.devicePixelRatio||1;return d}();this._mouseDetected=!1;var a=function(c){window.removeEventListener("mousedown",a,!1);window.removeEventListener("touchstart",a,!1);"touchstart"==c.type?(c.stopPropagation(),this._mouseDetected=
!1):this._mouseDetected=!0};window.addEventListener("mousedown",a,!1);window.addEventListener("touchstart",a,!1);this.cacherItemsList=this.CacheItemsList()}function t(a){this.delegate=a;this.appName=a.appName;this.id=this.appName+"_tag_";this.view=document.createElement("div");this.view.className="gmedia_amron_CollectionTagsCloud";this.list=document.createElement("ul");this.view.appendChild(this.list)}function u(a,c){this.delegate=a;this.appName=a.appName;this.index=c;this.view=document.createElement("div");
this.view.className="gmedia_amron_MasonryThumbPint";this.view.style.padding=e(this.appName).thumbSpacing/2+"px";this.imageHolder=document.createElement("div");this.imageHolder.className="gmedia_imageHolder";this.view.appendChild(this.imageHolder);this._size=k.Size(1,1);this.item=void 0;this.imageRetio=1;this.opacityDelay=void 0;this._display="none"}function q(a,c){this.delegate=a;this.appName=c;this.properties=void 0;this.itemsList=[];this.filteredList=[];this.presentedList=[];this.page_Amount=0;
this.scrollHandler=this.cureantPage=void 0;this.terms=[];this.term=void 0;this.tagsCloud=e(this.appName).tagsFilter?{0:e(this.appName).tagCloudAll}:void 0;this._filter=0;this.view=document.createElement("div");this.header=document.createElement("div");this.headerNavi=document.createElement("div");this.content=document.createElement("div");this.footer=document.createElement("div");this.tagsCloudView=void 0;this.header.className="gm_header";this.content.className="gm_content";this.footer.className=
"gm_footer";this.headerNavi.classList="gm_navi";this.header.appendChild(this.headerNavi);this.view.appendChild(this.header);this.view.appendChild(this.content);this.view.appendChild(this.footer);this.resizeTimeOut=void 0;this.viewWidth=0}function p(a,c){q.apply(this,arguments);this.view.className="gmedia_amron_MasonryCollection";this.header.style.padding="0 "+e(c).thumbSpacing/2+"px";this.content.style.paddingBottom=e(c).thumbSpacing+"px";this.columnsArr=[]}function v(a,c,b){k.copyProperties(a,this);
if(this.appApi){this.appName=c;this.appDiv=b;this.modal=void 0;this.collectionTranslateY=0;if(a=this.settings)e(this.appName).appApi=this.appApi,e(this.appName).post_url=a.post_url,e(this.appName).galleryID="gm"+b.getAttribute("data-gmid"),e(this.appName).appEventManager=k.GMEventsManager(),e(this.appName).key=!0,e(this.appName).lightBoxEnable="1"==a.lightBoxEnable?!0:!1,e(this.appName).thumbSpacing=parseInt(a.thumbSpacing),e(this.appName).collectionPreloaderColor="#"+a.collectionPreloaderColor,e(this.appName).linkTargetWindow=
a.linkTargetWindow,e(this.appName).infoBarTermsClickNewPageEnable="1"==a.infoBarTermsClickNewPageEnable?!0:!1,e(this.appName).tagsFilter="1"==a.tagsFilter?!0:!1,e(this.appName).tagCloudAll=a.tagCloudAll,e(this.appName).tagCloudTextColor="#"+a.tagCloudTextColor,e(this.appName).tagCloudBgColor="#"+a.tagCloudBgColor,e(this.appName).collectionThumbRecomendedWidth=parseInt(a.collectionThumbRecomendedWidth),e(this.appName).collectionThumbHoverColor=a.collectionThumbHoverColor,e(this.appName).collectionThumbContentBGColor=
"rgba(245,245,245,1)",e(this.appName).collectionThumbTitleShow="1"==a.collectionThumbTitleShow?!0:!1,e(this.appName).collectionThumbTitleColor=a.collectionThumbTitleColor,e(this.appName).collectionThumbFontSize=parseInt(a.collectionThumbFontSize),e(this.appName).collectionThumbDescriptionShow="1"==a.collectionThumbDescriptionShow?!0:!1,e(this.appName).collectionThumbDescriptionColor=a.collectionThumbDescriptionColor,e(this.appName).collectionThumbDescriptionFontSize=parseInt(a.collectionThumbDescriptionFontSize),
e(this.appName).collectionThumbSubMenuBackgroundColor=a.collectionThumbSubMenuBackgroundColor,e(this.appName).collectionThumbSubMenuBackgroundColorOver=a.collectionThumbSubMenuBackgroundColorOver,e(this.appName).collectionThumbSubMenuIconColor=a.collectionThumbSubMenuIconColor,e(this.appName).collectionThumbSubMenuIconHoverColor=a.collectionThumbSubMenuIconHoverColor,e(this.appName).collectionReadMoreButtonBGColor=a.collectionReadMoreButtonBGColor,e(this.appName).collectionReadMoreButtonLabelColor=
a.collectionReadMoreButtonLabelColor,e(this.appName).collectionReadMoreButtonBGColorHover=a.collectionReadMoreButtonBGColorHover,e(this.appName).collectionReadMoreButtonLabelColorHover=a.collectionReadMoreButtonLabelColorHover,e(this.appName).collectionReadMoreButtonLabel=a.collectionReadMoreButtonLabel,e(this.appName).modaBgColor=a.modaBgColor,e(this.appName).modalInfoBoxBgColor=a.modalInfoBoxBgColor,e(this.appName).modalInfoBoxTitleTextColor="#"+a.modalInfoBoxTitleTextColor,e(this.appName).modalInfoBoxTextColor=
"#"+a.modalInfoBoxTextColor,e(this.appName).infoBarCountersEnable="1"==a.infoBarCountersEnable?!0:!1,e(this.appName).infoBarDateInfoEnable="1"==a.infoBarDateInfoEnable?!0:!1,e(this.appName).shareTitlePlaceHolder=a.shareTitlePlaceHolder,e(this.appName).sliderThumbBarEnable="1"==a.sliderThumbBarEnable?!0:!1,e(this.appName).sliderThumbBarHoverColor=a.sliderThumbBarHoverColor,e(this.appName).sliderPreloaderColor="#"+a.sliderPreloaderColor,e(this.appName).sliderBgColor=a.sliderBgColor,e(this.appName).sliderHeaderFooterBgColor=
"#"+a.sliderHeaderFooterBgColor,e(this.appName).sliderNavigationColor=a.sliderNavigationColor,e(this.appName).sliderNavigationIconColor=a.sliderNavigationIconColor,e(this.appName).sliderItemTitleFontSize=parseInt(a.sliderItemTitleFontSize),e(this.appName).sliderItemTitleTextColor="#"+a.sliderItemTitleTextColor,e(this.appName).sliderThumbSubMenuBackgroundColor=a.sliderThumbSubMenuBackgroundColor,e(this.appName).sliderThumbSubMenuBackgroundColorOver=a.sliderThumbSubMenuBackgroundColorOver,e(this.appName).sliderThumbSubMenuIconColor=
a.sliderThumbSubMenuIconColor,e(this.appName).sliderThumbSubMenuIconHoverColor=a.sliderThumbSubMenuIconHoverColor,e(this.appName).sliderInfoEnable="1"==a.sliderInfoEnable?!0:!1,e(this.appName).sliderItemDownload="1"==a.sliderItemDownload?!0:!1,e(this.appName).sliderItemDiscuss="1"==a.sliderItemDiscuss?!0:!1,e(this.appName).sliderSocialShareEnabled="1"==a.sliderSocialShareEnabled?!0:!1,e(this.appName).sliderLikesEnabled="1"==a.sliderLikesEnabled?!0:!1;this.audioPlayer=void 0;this.bookmarkStatusShow=
e(this.appName).bookmarkShowState;e&&(this.currentLocation=void 0,this.collections=[],this.terms={},this.appDiv.style.position="relative",this.appDiv.style.height="auto",this.appDivWidth=this.appDiv.clientWidth,b=new p(this,this.appName),this.collections.push(b),this.appDiv.appendChild(b.view),b.init(),e(this.appName).appEventManager.addGMEventListener(l.EXT_SCRIPTS_READY,this,"externalScriptsReady"),b=e(this.appName).module_url+"/js/components/",k.loadExtScripts([b+"gm_vit_slider.js",b+"gm_vit_itemMenu.js",
b+"gm_vit_modalWin.js"],this,l.EXT_SCRIPTS_READY))}}r.prototype={moduleSettings:function(a){return window[a]&&window[a].settings?window[a].settings:null},get passiveListener(){return this.isPassiveListener()?{passive:!1,capture:!1}:!1},isPassiveListener:function(){var a=!1;try{var c=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveListener",null,c)}catch(b){}return a},get requestAnimationFrame(){return window.requestAnimationFrame||window.mozRequestAnimationFrame||
window.webkitRequestAnimationFrame||window.msRequestAnimationFrame},get cancelAnimationFrame(){return window.cancelAnimationFrame||window.mozCancelAnimationFrame},get whichTransitionEventEnd(){var a,c=document.createElement("fakeelement"),b={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in b)if(void 0!==c.style[a])return b[a]},get Device(){return this._device},get is_touch_device(){return navigator.maxTouchPoints||
"ontouchstart"in window},get getScrollbarWidth(){var a=document.createElement("div");a.style.visibility="hidden";a.style.width="100px";a.style.msOverflowStyle="scrollbar";document.body.appendChild(a);var c=a.offsetWidth;a.style.overflow="scroll";var b=document.createElement("div");b.style.width="100%";a.appendChild(b);b=b.offsetWidth;a.parentNode.removeChild(a);return c-b},get hasScrollbar(){if("number"===typeof window.innerWidth)return window.innerWidth>document.documentElement.clientWidth;var a=
document.documentElement||document.body;if("undefined"!==typeof a.currentStyle)var c=a.currentStyle.overflow;c=c||window.getComputedStyle(a,"").overflow;if("undefined"!==typeof a.currentStyle)var b=a.currentStyle.overflowY;b=b||window.getComputedStyle(a,"").overflowY;a=a.scrollHeight>a.clientHeight;var d=/^(visible|auto)$/.test(c)||/^(visible|auto)$/.test(b);return a&&d||"scroll"===c||"scroll"===b},get miniScreen(){return 500>window.screen.height||500>window.screen.width},get mouseDetected(){return this._mouseDetected},
get youTubeCode(){return'<iframe src="https://www.youtube.com/embed/%id%?rel=0&showinfo=0&autoplay=1&wmode=transparent" frameborder="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},get vimeoCode(){return'<iframe src="https://player.vimeo.com/video/%id%?byline=0&portrait=0&autoplay=1" frameborder="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},copyProperties:function(a,c){for(var b in a)c[b]=a[b]},Rect:function(a,c,b,d){return{x:a,y:c,width:b,height:d}},
Size:function(a,c){return{width:a,height:c}},Point:function(a,c){return{x:a,y:c}},findHighestZIndex:function(a){for(var c=99999,b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(1==d.nodeType&&"SCRIPT"!=d.nodeName)var e=document.defaultView.getComputedStyle(d,null).getPropertyValue("z-index");e>c&&"auto"!=e&&(c=parseInt(e))}return c},timeConverter:function(a){a=new Date(1E3*a);var c=new Date,b=new Date(Date.now()-864E5),d=a.getFullYear(),e="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getMonth()],
f=a.getDate(),m=a.getHours(),g=a.getMinutes();return a.setHours(0,0,0,0)==c.setHours(0,0,0,0)?"Today, "+m+":"+g:a.setHours(0,0,0,0)==b.setHours(0,0,0,0)?"Yesterday, "+m+":"+g:d==c.getFullYear()?f+" "+e+", "+d:f+" "+e+" "+d},createPreloaderView:function(a){var c=0,b=document.createElement("div");b.className="gmedia_v2_Preloader";var d=document.createElement("div");d.style.position="absolute";d.style.width="8px";d.style.height="8px";d.style.margin="-4px";d.style.left="50%";d.style.top="50%";d.style.borderRadius=
"50%";d.style.backgroundColor=a;b.appendChild(d);d=document.createElement("div");d.className="c-spinner";d.style.position="absolute";d.style.width="36px";d.style.height="36px";d.style.margin="-18px";d.style.left="50%";d.style.top="50%";for(var e=0;8>e;e++){var f=document.createElement("div");f.style.position="absolute";f.style.top="50%";f.style.left="50%";f.style.marginTop="-4px";f.style.marginLeft="-4px";f.style.width="8px";f.style.height="8px";f.style.backgroundColor=a;f.style.borderRadius="100%";
f.style.transform="rotate("+c+"deg) translate(18px)";c+=45;d.appendChild(f)}b.appendChild(d);return b},trace:function(a){if(1==arguments.length)console.log(a);else{for(var c="",b=0;b<arguments.length;b++)c+=arguments[b]+", ";c=c.slice(0,-2);console.log(c)}},preventDefaultForScrollKeys:function(a){if({37:1,38:1,39:1,40:1}[a.keyCode])return a.preventDefault(),!1},preventDefault:function(a){a=a||window.event;a.preventDefault&&a.preventDefault();a.returnValue=!1},disableBodyScroll:function(){document.getElementsByTagName("html")[0].classList.add("gmedia_PopUpActive")},
enableBodyScroll:function(){document.getElementsByTagName("html")[0].classList.remove("gmedia_PopUpActive")},disableBodyScrollSlider:function(){window.addEventListener&&(window.addEventListener("wheel",this.preventDefault,this.passiveListener),window.addEventListener("mousewheel",this.preventDefault,this.passiveListener),window.addEventListener("touchmove",this.preventDefault,this.passiveListener));document.onkeydown=this.preventDefaultForScrollKeys},enableBodyScrollSlider:function(){window.removeEventListener&&
(window.removeEventListener("wheel",this.preventDefault,this.passiveListener),window.removeEventListener("mousewheel",this.preventDefault,this.passiveListener),window.removeEventListener("touchmove",this.preventDefault,this.passiveListener));document.onkeydown=null},collapseElementsInElemt:function(a,c){for(var b=[],d=0;d<a.childNodes.length;d++){var e={},f=a.childNodes[d];1==f.nodeType&&"SCRIPT"!=f.nodeName&&f!==c&&(e.element=f,e.height=null,e.overflow=null,""!=f.style.height&&(e.height=f.style.height),
""!=f.style.overflow&&(e.overflow=f.style.overflow),b.push(e),f.style.overflow="hidden",f.style.height="0")}return b},recoverElements:function(a){if(0!=a.length)for(var c=0;c<a.length;c++){var b=a[c].element;b&&(a[c].overflow?b.style.overflow=a[c].overflow:b.style.removeProperty("overflow"),a[c].height?b.style.height=a[c].height:b.style.removeProperty("height"))}},hexToRgbaStrin:function(a,c){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,c,e,f){return c+c+e+e+f+f});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?
"rgba("+parseInt(a[1],16)+","+parseInt(a[2],16)+","+parseInt(a[3],16)+","+c+")":null},getFrameForBoxWithMode:function(a,c,b){var d=a.width,e=a.height;a=c.width;c=c.height;b?b=Math.max(a/d,c/e):(b=Math.min(a/d,c/e),b=1<b?1:b);d=Math.round(d*b);e=Math.round(e*b);return this.Rect(Math.round((a-d)/2),Math.round((c-e)/2),d,e)},getItemFrameByIndexForBox:function(a,c,b,d,e,f){var h=1;f&&(h=f);e=Math.min(c,e);e=Math.floor(c/e);c=1<e?(c-(e-1)*b)/e:c;h*=c;f=Math.ceil((a+1)/e)-1;return this.Rect((a-f*e)*(c+
b),f*(h+d),c,h)},fadeOut:function(a,c,b){function d(){var h=(new Date).getTime()-f,g=h/b;1>g?(g=1-e(g),a.style.opacity=String(g),setTimeout(d,Math.min(25,b-h))):(a.style.opacity="0",c&&c())}b||(b=500);var e=Math.sqrt,f=(new Date).getTime();d()},ellipsizeTextBoxToLine:function(a,c){a.innerHTML=a.textContent||a.innerText||"";var b=a.innerHTML,d=a.innerHTML.split(" ");a.innerHTML=d[0].substring(0,3);c*=a.clientHeight;for(a.innerHTML=b;a.clientHeight>c;)d.pop(),a.innerHTML=d.join(" ")+" ..."},ellipsizeTextBox:function(a){a.innerHTML=
a.textContent||a.innerText||"";for(var c=a.innerHTML.split(" ");a.scrollHeight>a.offsetHeight;)c.pop(),a.innerHTML=c.join(" ")+" ..."},scrollToY:function(a,c){var b=window.pageYOffset,d=Math.PI/(c/15),e=b/2,f=0,m,g=setInterval(function(){window.pageYOffset>a?(f+=1,m=e-e*Math.cos(f*d),window.scrollTo(0,b-m)):clearInterval(g)},15)},toggleFullScreen:function(a){var c=document.webkitIsFullScreen||document.mozFullScreen||!1;a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||
function(){return!1};document.cancelFullScreen=document.cancelFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen||function(){return!1};c?document.cancelFullScreen():a.requestFullScreen()},loadExtScripts:function(a,c,b){for(var d=0,h=0;h<a.length;h++){var f=document.createElement("script");f.src=a[h];f.async=!0;f.onload=f.onreadystatechange=function(){d+=1;d==a.length&&e(c.appName).appEventManager.dispatchGMEvent(k.GMEvent(b,self))};document.body.appendChild(f)}},CacheItemsList:function(){function a(){b.cached+=
1;c(b.lastIndex+1>=b.itemsList.length?0:b.lastIndex+1)}function c(d){!b.itemsList||b.cached==b.itemsList.length&&!b.amount||b.amount&&b.cached>=b.amount||(b.amount&&(b.amount=Math.min(b.amount,b.itemsList.length)),b.currentItem=b.itemsList[d].webView,b.lastIndex=d,b.currentItem.complete?(b.cached+=1,c(b.lastIndex+1>=b.itemsList.length?0:b.lastIndex+1)):b.currentItem.addEventListener("load",a,!1))}var b={cached:0,itemsList:void 0,currentItem:void 0,amount:void 0,lastIndex:void 0,init:function(d,e,
f){b.currentItem&&b.currentItem.removeEventListener("load",a,!1);b.amount=f;b.cached=0;b.currentItem=void 0;b.lastIndex=e;b.itemsList=d;void 0===e&&(e=0);c(e)},status:function(){return{list:b.itemsList,index:b.lastIndex}}};return b},GMEventsManager:function(){return{_listenerSet:{},addGMEventListener:function(a,c,b){this._listenerSet[a]||(this._listenerSet[a]=[]);this._listenerSet[a].push({listener:c,handler:b})},removeGMEventListener:function(a,c,b){if(this._listenerSet[a])for(var d=0;d<this._listenerSet[a].length;d++)this._listenerSet[a][d].listener==
c&&this._listenerSet[a][d].handler==b&&(this._listenerSet[a].splice(d,1),d=this._listenerSet[a].length)},dispatchGMEvent:function(a){if(this._listenerSet[a.type])for(var c=this._listenerSet[a.type],b=0;b<c.length;b++){var d=c[b];if(d&&d.listener&&"function"==typeof d.listener[d.handler])d.listener[d.handler](a)}}}},GMEvent:function(a,c,b){var d={};d.type=a;d.params=b;d.target=c;return d},request:function(a,c,b,d){var e=this,f=new XMLHttpRequest;f.open("POST",this.moduleSettings(c.appName).appApi,
!0);f.onreadystatechange=function(){4==this.readyState&&(200!=this.status?b&&e.moduleSettings(c.appName).appEventManager.dispatchGMEvent(e.GMEvent(b,c,{error:this.statusText,params:d})):b&&e.moduleSettings(c.appName).appEventManager.dispatchGMEvent(e.GMEvent(b,c,{data:this.responseText,params:d})))};f.onerror=function(e){1==confirm("Failed to load resource: The network connection was lost. Let's try again?")&&request(a,c,b,d)};try{f.send(a),e.moduleSettings(c.appName).appEventManager.dispatchGMEvent(e.GMEvent(l.REQUEST_START,
c,null))}catch(m){e.trace(m)}},Item:function(a,c){var b={get webView(){if(this.webImg.src)return b.webImg;this.webImg.src=this.itemViewSrc;return this.webImg}};this.copyProperties(a,b);b.appName=c;b.idPrefix=void 0;b.webImg=new Image;b.webImgFrame=this.Rect(0,0,0,0);b.webImg.addEventListener("load",function(){this.classList.add("onLoad")},!1);if(b.link&&""!=b.link){a=b.link;var d;a.match(/youtu\.be/i)||a.match(/youtube\.com/i)?(c=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&\?]*).*/,
(a=a.match(c))&&11==a[7].length&&(d=a[7]),void 0!==d&&(b.mime_type="video/youtube",b.videoId=d,b.link=void 0)):a.match(/vimeo\.com/i)&&(c=/(www\.)?vimeo.com\/(\d+)($|\/)/,(a=a.match(c))&&(d=a[2]),void 0!==d&&(b.mime_type="video/vimeo",b.videoId=d,b.link=void 0))}"audio/mpeg"==b.mime_type&&(b.type="audio");"image"==b.mime_type.split("/")[0]&&(b.type="image");"video"==b.mime_type.split("/")[0]&&(b.type="video");b.hasTag=function(a){if("all"==a)return!0;if(!b.tags||0==b.tags.length)return!1;for(var c=
0;c<b.tags.length;c++)if(b.tags[c].term_id==a)return!0};b.itemViewSrc=b.meta?b.meta.web?b.meta.web.link:b.meta.original?b.meta.original.link:b.meta.thumb?b.meta.thumb.link:null:null;b.itemViewThumbSrc=b.meta?b.meta.thumb?b.meta.thumb.link:b.meta.web?b.meta.web.link:null:null;b.itemViewSize=b.meta?b.meta.web?this.Size(b.meta.web.width,b.meta.web.height):b.meta.original?this.Size(b.meta.original.width,b.meta.original.height):this.Size(300,300):this.Size(300,300);b.itemViewThumbSize=b.meta?b.meta.thumb?
this.Size(b.meta.thumb.width,b.meta.thumb.height):b.meta.web?this.Size(b.meta.web.width,b.meta.web.height):this.Size(300,300):this.Size(300,300);return b},Term:function(a,c){var b=this,d={set gmedia__in(a){this._query&&(this._query.gmedia__in=a.toString(),this._gmedia_in=a,this.count=a.length,"myCollection"==this.taxonomy&&this._query&&(this.sharelink=b.moduleSettings(c).post_url+"/?"+b.moduleSettings(c).galleryID+"[gmedia__in]="+this._query.gmedia__in))},get gmedia__in(){return this._gmedia_in},
get taxony_type(){switch(this.taxonomy){case "gmedia_album":return"albums";case "gmedia_category":return"categories";case "gmedia_tag":return"tags";case "myCollection":return"gmedia__in";default:return null}},get term_id(){return"myCollection"==this.taxonomy?this.taxony_type+"-"+this.gmedia__in.toString():this._term_id},set term_id(a){this._term_id=a},get query(){var a=void 0,b;if("myCollection"==this.taxonomy)return b={orderby:"gmedia__in",order:"ASC",gmedia__in:this._gmedia_in.toString()};switch(this.taxonomy){case "gmedia_album":a=
"album__in";break;case "gmedia_category":a="category__in";break;case "gmedia_tag":a="tag__in"}b={per_page:0,admin:!1,page:1};b[a]=[this.term_id];return b}};this.copyProperties(a,d);a.term_id&&(d._term_id=a.term_id);d.appName=c;d.key=void 0;d._gmedia_in=[];d.meta&&(a=this.Meta(d.meta,d.appName),d.meta=a);"gmedia_tag"==d.taxonomy&&(d.name="#"+d.name);"myCollection"==d.taxonomy&&d._query&&(d.gmedia__in=d._query.gmedia__in.split(","));return d},termDataByQueryNameId:function(a,c,b){if(!a.gmedia__in)return null;
var d=a.gmedia__in.split(",").length,e=a.orderby,f=a.order;return{count:d,name:c,meta:{_order:f,_orderby:e,order:f,orderby:e},taxonomy:"myCollection",term_id:b,_query:a}},termsListFromAppQuery:function(a){var c=[],b=void 0;if(a.album__in){var d=a.album__in.split(",");for(b in d)c.push({taxonomy_type:"albums",term_id:d[b]})}if(a.category__in)for(b in d=a.category__in.split(","),d)c.push({taxonomy_type:"categories",term_id:d[b]});if(a.tag__in)for(b in a=a.tag__in.split(","),a)c.push({taxonomy_type:"tags",
term_id:a[b]});return 0<c.length?c:void 0},Meta:function(a,c){var b={};this.copyProperties(a,b);b.appName=c;b._cover&&(b._cover=this.Item(a._cover,b.appName));a=b._cover?b._cover:null;b.cover=a;return b}};var k=new r,x=k.trace,e=k.moduleSettings,l={REQUEST_START:"REQUEST_START",COLLECTION_DATA_REDY:"COLLECTION_DATA_REDY",COUNTERS_UPDATED:"COUNTERS_UPDATED",NEED_MODAL:"NEED_MODAL",NEED_LIGHTBOX:"NEED_LIGHTBOX",REMOVE_LIGHTBOX:"REMOVE_LIGHTBOX",NEED_NEW_COLLECTION:"NEED_NEW_COLLECTION",NEED_PREV_COLLECTION:"NEED_PREV_COLLECTION",
NEED_NEW_COLLECTION_BY_TERM:"NEED_NEW_COLLECTION_BY_TERM",FULLSCREEN_SWITCH:"FULLSCREEN_SWITCH"};t.prototype={updateView:function(){var a=this.delegate.tagsCloud,c=[],b=[],d;for(d in a)"0"!=d&&c.push(a[d].toLowerCase());c.sort();c.splice(0,0,a["0"].toLowerCase());for(d=0;d<c.length;d++)for(var h in a)if(a[h].toLowerCase()==c[d]){var f=this.createTag(h,a[h]);b.push(f);this.list.appendChild(f);delete a[h]}this.selectedTag=document.getElementById(this.id+this.delegate.filtredById);this.selectedTag.style.backgroundColor=
e(this.appName).tagCloudTextColor;this.selectedTag.style.color=e(this.appName).tagCloudBgColor;this.selectedTag.style.cursor="default"},createTag:function(a,c){function b(a){var b=this.id.split("_")[this.id.split("_").length-1];if(d.selectedTag!=this)switch(a.type){case "click":d.selectedTag=document.getElementById(d.id+d.delegate.filtredById);d.selectedTag.style.color=e(d.appName).tagCloudTextColor;d.selectedTag.style.backgroundColor=e(d.appName).tagCloudBgColor;d.selectedTag.style.cursor="pointer";
d.delegate.filtred(b);d.selectedTag=document.getElementById(d.id+d.delegate.filtredById);d.selectedTag.style.cursor="default";break;case "mouseenter":this.style.backgroundColor=e(d.appName).tagCloudTextColor;this.style.color=e(d.appName).tagCloudBgColor;break;case "mouseleave":this!=d.selectedTag&&(this.style.color=e(d.appName).tagCloudTextColor,this.style.backgroundColor=e(d.appName).tagCloudBgColor)}}var d=this,h=document.createElement("li");h.appendChild(document.createTextNode(c));h.id=this.id+
a;h.style.color=e(this.appName).tagCloudTextColor;h.style.backgroundColor=e(this.appName).tagCloudBgColor;h.addEventListener("click",b,!1);h.addEventListener("mouseenter",b,!1);h.addEventListener("mouseleave",b,!1);return h}};u.prototype={init:function(){function a(a){if(e(f.appName).lightBoxEnable)switch(a.type){case "mouseenter":this.classList.add("gmedia_hover");k&&k.classList.add("gmedia_hover");break;case "mouseleave":this.classList.remove("gmedia_hover");k&&k.classList.remove("gmedia_hover");
break;case "click":this.classList.remove("gmedia_hover"),k&&k.classList.remove("gmedia_hover"),f.delegate.itemAction(f.index,"lightBox")}}function c(a){a.classList.remove("gmedia_hover");"like"==a.getAttribute("type")&&a.getAttribute("like")||"bookmark"==a.getAttribute("type")&&a.getAttribute("mark")?a.style.backgroundColor=w:(a.style.backgroundColor=w,a.childNodes[0].style.fill=l)}function b(a){"click"==a.type?d&&(f.delegate.itemAction(f.index,this.getAttribute("type")),miniScreen&&c(this)):"mouseenter"==
a.type?(this.classList.add("gmedia_hover"),this.style.backgroundColor=y,"bookmark"==this.getAttribute("type")&&this.getAttribute("mark")||(this.childNodes[0].style.fill=p)):"mouseleave"==a.type&&c(this)}var d=this.delegate.itemsList[this.index];this.item=d;var h=this.delegate.itemWidth;this.type=d.type;this.itemViewSrc=!1;this.img=new Image;var f=this;this.img.onload=function(){this.setAttribute("alt",d.title);1.1<f.view.clientWidth/this.naturalWidth&&d.itemViewSrc&&!f.itemViewSrc&&(this.src=d.itemViewSrc,
f.itemViewSrc=!0);f.imageHolder.style.minHeight=null;this.style.opacity="1"};this.imageHolder.appendChild(this.img);if(e(this.appName).lightBoxEnable){var k=document.createElement("div");k.className="gmedia_imageOver";k.style.backgroundColor=e(this.appName).collectionThumbHoverColor;this.imageHolder.appendChild(k);var g=document.createElement("div");g.className="gmedia_zoom";switch(this.item.type){case "video":"vimeo"==this.item.mime_type.split("/")[1]?(g.classList.add("media"),g.innerHTML='<svg enable-background="new 0 0 56.693 56.693" height="56.693px" id="Layer_1" version="1.1" viewBox="0 0 56.693 56.693" width="56.693px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M3.602,22.974l2.01,2.636c0,0,4.146-3.267,5.528-1.634c1.382,1.634,6.656,21.357,8.417,24.997  c1.537,3.192,5.777,7.413,10.426,4.397c4.646-3.014,20.098-16.205,22.863-31.781c2.764-15.574-18.594-12.313-20.854,1.256  c5.652-3.395,8.671,1.38,5.778,6.784c-2.889,5.399-5.527,8.921-6.908,8.921c-1.379,0-2.441-3.612-4.021-9.928  c-1.635-6.53-1.624-18.291-8.416-16.958C12.019,12.921,3.602,22.974,3.602,22.974z"/></svg>',
g.firstChild.style.fill="#00adef"):(g.classList.add("media"),g.innerHTML='<svg data-name="Layer 21" height="24" id="Layer_21" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title/><path d="M21.80731,7.805a2.79915,2.79915,0,0,0-2.54907-2.53906C17.69061,5.13586,15.36707,5,12.50012,5c-3.45251,0-6.05865.14105-7.74353.27332A2.79932,2.79932,0,0,0,2.1925,7.815C2.08936,8.90021,2,10.33344,2,12.0423c0,1.66632.08862,3.07422.19128,4.14594a2.79852,2.79852,0,0,0,2.56384,2.53833C6.43994,18.85883,9.04657,19,12.50012,19c2.86694,0,5.19049-.13586,6.75812-.266a2.799,2.799,0,0,0,2.54907-2.539C21.91052,15.11548,22,13.69189,22,12S21.91052,8.88452,21.80731,7.805ZM9.77594,14.93878V9.06122L15.574,12Z"/></svg>',
g.firstChild.style.fill="#e02f2f");break;case "audio":g.classList.add("media");g.innerHTML='<svg version="1.1" viewBox="0 0 58 94" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M37.992,0h-8.021v65.358c-4.435-1.706-10.174-1.73-15.835,0.328C3.994,69.377-2.049,78.355,0.638,85.736   c2.688,7.383,13.088,10.374,23.229,6.683c8.614-3.134,14.249-10.082,14.111-16.626l0.014-53.451   c13.986,2.204,14.943,19.884,13.268,24.842c-0.636,1.879,0.484,3.286,2.598,0C68.938,23.726,37.992,13.376,37.992,0z"/></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg>';
g.firstChild.style.fill="#7a7a7a";break;default:g.innerHTML='<svg fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/></svg>'}this.imageHolder.appendChild(g)}this.imageHolder.addEventListener("mouseenter",a,!1);this.imageHolder.addEventListener("mouseleave",
a,!1);this.imageHolder.addEventListener("click",a,!1);this.img.src=1.1<h/d.itemViewThumbSize.width?d.itemViewSrc:d.itemViewThumbSrc;this.imageRetio=d.itemViewSize.height/d.itemViewSize.width;this.imageHolder.style.minHeight=this.imageRetio*h+"px";h=document.createElement("div");h.className="gmedia_itemContent";h.style.backgroundColor=e(this.appName).collectionThumbContentBGColor;this.view.appendChild(h);g=void 0;e(this.appName).collectionThumbTitleShow&&d.title&&""!=d.title&&(g=document.createElement("div"),
g.className="gmedia_gmedia_itemTitle",g.style.fontSize=e(this.appName).collectionThumbFontSize+"px",g.style.color=e(this.appName).collectionThumbTitleColor,g.innerHTML=d.title,h.appendChild(g));e(this.appName).collectionThumbDescriptionShow&&d.description&&""!=d.description&&(g=document.createElement("div"),g.className="gmedia_itemDescription",g.style.fontSize=e(this.appName).collectionThumbDescriptionFontSize+"px",g.style.color=e(this.appName).collectionThumbDescriptionColor,g.innerHTML=d.description,
h.appendChild(g));g=document.createElement("div");g.className="gmedia_itemMenuHolder";var l=e(this.appName).collectionThumbSubMenuIconColor,w=e(this.appName).collectionThumbSubMenuBackgroundColor,y=e(this.appName).collectionThumbSubMenuBackgroundColorOver,p=e(this.appName).collectionThumbSubMenuIconHoverColor;if(d.link){var n=document.createElement("a");n.className="gmedia_itemReadMore";n.innerHTML=e(this.appName).collectionReadMoreButtonLabel;n.style.backgroundColor=e(this.appName).collectionReadMoreButtonBGColor;
n.style.color=e(this.appName).collectionReadMoreButtonLabelColor;n.setAttribute("target",e(this.appName).linkTargetWindow);n.setAttribute("href",d.link);n.onmouseenter=function(){this.style.backgroundColor=e(f.appName).collectionReadMoreButtonBGColorHover;this.style.color=e(f.appName).collectionReadMoreButtonLabelColorHover};n.onmouseleave=function(){this.style.backgroundColor=e(f.appName).collectionReadMoreButtonBGColor;this.style.color=e(f.appName).collectionReadMoreButtonLabelColor};n.addEventListener("click",
b,!1);g.appendChild(n)}0<g.childNodes.length&&h.appendChild(g)},resize:function(a){return this.view.clientHeight},updateSomeData:function(){},set mark(a){this.bookmarkButton&&(a?(this.bookmarkButton.getElementsByTagName("svg")[0].style.fill="red",this.bookmarkButton.setAttribute("mark","true")):(this.bookmarkButton.getElementsByTagName("svg")[0].style.fill=this.bookmarkButton.classList.contains("gmedia_hover")?e(this.appName).collectionThumbSubMenuIconHoverColor:e(this.appName).collectionThumbSubMenuIconColor,
this.bookmarkButton.removeAttribute("mark")))},get mark(){return this.bookmarkButton?!0:!1},set like(a){this.likeButton&&(a?(this.likeButton.getElementsByTagName("svg")[0].style.fill="red",this.likeButton.style.cursor="default",this.likeButton.style.pointerEvents="none",this.likeButton.setAttribute("like","true")):(this.likeButton.childNodes[0].style.fill=this.iconColor,this.likeButton.style.cursor="pointer",this.likeButton.style.pointerEvents="all",this.likeButton.removeAttribute("like")))},get like(){return this.likeButton?
!0:!1},set visibility(a){this.view.style.visibility=a},set display(a){"none"==a&&clearTimeout(this.opacityDelay);this._display=this.view.style.display=a;this.updateSomeData()},get display(){return this._display},set opacity(a){var c=this;a.delay?this.opacityDelay=setTimeout(function(){c.view.style.opacity=a.opacity},a.delay):(clearTimeout(this.opacityDelay),c.view.style.opacity=a.opacity)}};q.prototype={init:function(){this.showPreloader(!0)},startRequest:function(a){var c={};c.backgroundColor=e(this.appName).collectionThumbSubMenuBackgroundColor;
c.backgroundColorOver=e(this.appName).collectionThumbSubMenuBackgroundColorOver;c.iconColor=e(this.appName).collectionThumbSubMenuIconColor;c.iconColorOver=e(this.appName).collectionThumbSubMenuIconHoverColor;this.itemMenu=this.delegate.itemMenuConstructor(this.delegate,k,c,!1);this.query=a;this.query.per_page=0;this.query.page=1;e(this.appName).appEventManager.addGMEventListener(l.COLLECTION_DATA_REDY,this,"dataLoaded");k.request(JSON.stringify({library:this.query}),this,l.COLLECTION_DATA_REDY)},
showPreloader:function(a){var c=void 0;if(a)document.getElementById(this.appName+"_preloader")||(c=k.createPreloaderView(k.hexToRgbaStrin(e(this.appName).collectionPreloaderColor,.7)),c.id=this.appName+"_preloader",this.view.appendChild(c));else if(document.getElementById(this.appName+"_preloader")){var b=this;c=document.getElementById(this.appName+"_preloader");k.fadeOut(c,function(){b.view&&b.view.removeChild(c)},500)}},dataLoaded:function(a){if(a=a.params.data){try{var c=JSON.parse(a);c.data&&
(this.addItemsToCollection(c.data),this.trySortItemsByTerms());e(this.appName).lightBoxEnable&&this.delegate.startItem&&this.tryOpenLightboxForID(this.delegate.startItem)}catch(b){x(b)}this.showPreloader(!1);this.itemsList&&this.updateViewByData()}},tryOpenLightboxForID:function(a){for(var c=0;c<this.filteredCollection.length;c++)a==this.filteredCollection[c].ID&&(e(this.appName).appEventManager.dispatchGMEvent(k.GMEvent(l.NEED_LIGHTBOX,this,{collection:this,index:c})),c=this.filteredCollection.length)},
createTermsCollectionAndUpdateProperties:function(a){function c(a){var c={},e;for(e in a){var f=k.Term(a[e],b.appName);c[f.term_id]=f;f.itemsList=[];if(b.itemsList)for(var h=0;h<b.itemsList.length;h++){var l=b.itemsList[h];if(l[f.taxonomy_type]){var p=l[f.taxonomy_type],n;for(n in p)p[n].term_id==f.term_id&&(f.itemsList.push(l),d.push(l),b.itemsList.splice(h,1),--h)}}}return c}this.properties||(this.properties={});var b=this,d=[];this.terms=[];for(var e in a)"album__in"==e||"category__in"==e||"tag__in"==
e?this.terms.push(c(a[e])):this.properties[e]=a[e];this.itemsList=d.concat(this.itemsList)},addItemsToCollection:function(a){for(var c=0;c<a.length;c++){var b=k.Item(a[c],this.appName);b.index=this.itemsList.length+c;if(b.tags&&0<b.tags.length)for(var d=0;d<b.tags.length;d++){var e=b.tags[d];this.tagsCloud&&(this.tagsCloud[e.term_id]=e.name)}this.itemsList.push(b)}},trySortItemsByTerms:function(){this.queryTermsList=k.termsListFromAppQuery(this.query);if(this.itemsList&&this.queryTermsList){for(var a=
[],c=0;c<this.queryTermsList.length;c++)for(var b=this.queryTermsList[c],d=0;d<this.itemsList.length;d++){var e=this.itemsList[d];if(e[b.taxonomy_type]){var f=e[b.taxonomy_type],l;for(l in f)f[l].term_id==b.term_id&&(a.push(e),this.itemsList.splice(d,1),--d)}}this.itemsList=a.concat(this.itemsList)}},itemAction:function(a,c){if(!this.dragging){var b=this.filteredCollection[a];switch(c){case "lightBox":e(this.appName).appEventManager.dispatchGMEvent(k.GMEvent(l.NEED_LIGHTBOX,this,{collection:this,
index:a}));break;case "share":e(this.appName).appEventManager.dispatchGMEvent(k.GMEvent(l.NEED_MODAL,self,{type:"share",item:b}));break;case "link":b.link&&window.open(b.link,e(this.appName).linkTargetWindow);break;case "coments":window.open(b.sharelink+"/#comments",e(this.appName).linkTargetWindow);break;case "like":this.delegate.likeItem=b;break;case "bookmark":this.delegate.bookmarkItem=b}}},refteshDataInItem:function(){for(var a=0;a<this.filteredCollection.length;a++)this.filteredCollection[a].view.updateSomeData()},
activate:function(){this.updateLayout();(this.scrollHandler=this.scrollHandlerFunction())&&window.addEventListener("scroll",this.scrollHandler,!1)},deactivate:function(){e(this.appName).appEventManager.removeGMEventListener(l.COLLECTION_DATA_REDY,this,"dataLoaded");window.removeEventListener("scroll",this.scrollHandler,!1);this.scrollHandler=void 0;this.removePresentedItems()},removeItemViewFormStage:function(){this.removePresentedItems();this.presentedList=[];this.cureantPage=void 0},removePresentedItems:function(){for(var a=
0;a<this.presentedList.length;a++)this.presentedList[a].display="none"},showPresentedItems:function(){for(var a=0;a<this.presentedList.length;a++)this.presentedList[a].display="block"},createLayout:function(){this.scrollHandler||(this.scrollHandler=this.scrollHandlerFunction())&&window.addEventListener("scroll",this.scrollHandler,!1);this.page_Amount=Math.min(20,this.filteredCollection.length)},updateLayout:function(){},scrollHandlerFunction:function(){return!1},resize:function(){var a=this;clearTimeout(this.resizeTimeOut);
k.is_touch_device?this.resizeTimeOut=setTimeout(function(){a.resizeDelay()},150):this.resizeDelay()},resizeDelay:function(){this.viewWidth!=this.view.clientWidth&&(this.updateLayout(),this.viewWidth=this.view.clientWidth)},filtred:function(a){window.removeEventListener("scroll",this.scrollHandler,!1);this.scrollHandler=void 0;this.removeItemViewFormStage();this.filtredById=a;this.createLayout()},updateTagsCloud:function(){0!=this.filteredCollection.length&&(this.tagsCloudView||(this.tagsCloudView=
new t(this),this.header.appendChild(this.tagsCloudView.view)),this.tagsCloud&&this.tagsCloudView.updateView())},set filtredById(a){if(this.itemsList&&(this.filteredList=[],this._filter=a,0!==a))for(var c=0;c<this.itemsList.length;c++){var b=this.itemsList[c];b.hasTag(a)&&this.filteredList.push(b)}},get filtredById(){return this._filter},get filteredCollection(){return 0<this.filteredList.length?this.filteredList:this.itemsList}};p.prototype=Object.create(q.prototype,{updateViewByData:{value:function(){if(this.itemsList)for(var a=
0;a<this.itemsList.length;a++){var c=new u(this,a);this.itemsList[a].view=c;c.init()}e(this.appName).tagsFilter&&this.updateTagsCloud();this.createLayout()}},createLayout:{value:function(){q.prototype.createLayout.apply(this,arguments);this.createColumns();this.addPageToStage()}},updateLayout:{value:function(){if(0==this.createColumns())this.presentedList&&this.presentedList[0]&&"none"==this.presentedList[0].display&&this.showPresentedItems();else{this.removePresentedItems();for(var a=0;a<this.presentedList.length;a++)this.arangeItemToColum(this.presentedList[a])}}},
createColumns:{value:function(){var a=Math.floor(this.content.clientWidth/Math.min(this.content.clientWidth,e(this.appName).collectionThumbRecomendedWidth));if(this.columnsArr.length!=a){for(var c=0;c<this.columnsArr.length;c++)this.content.removeChild(this.columnsArr[c]);this.columnsArr=[];for(c=0;c<a;c++){var b=document.createElement("div");b.className="collectionColumn";b.style.width=100/a+"%";this.columnsArr.push(b);this.content.appendChild(b)}return!0}return!1}},bottomSpace:{get:function(){return this.content.getBoundingClientRect().bottom-
window.innerHeight}},scrollHandlerFunction:{value:function(a){var c=this;return function(){200>c.bottomSpace&&c.addPageToStage()}}},addPageToStage:{value:function(){void 0===this.cureantPage&&(this.cureantPage=0);clearTimeout(this.layoutSizerDelay);if(!(this.cureantPage>=Math.ceil(this.filteredCollection.length/this.page_Amount))){for(var a=this.cureantPage*this.page_Amount,c=Math.min(a+this.page_Amount,this.filteredCollection.length),b=1;a<c;a++){var d=this.filteredCollection[a].view;d.index=a;d.opacity=
{opacity:0,delay:0};this.addItemToStage(d);d.opacity={opacity:1,delay:100*b};b+=1}this.cureantPage+=1;var e=this;this.layoutSizerDelay=setTimeout(function(){200>e.bottomSpace&&e.addPageToStage()},1E3)}}},getColumWithMinHeight:{value:function(){for(var a=this.columnsArr[0].clientHeight,c=0,b=1;b<this.columnsArr.length;b++)a!=Math.min(a,this.columnsArr[b].clientHeight)&&(a=Math.min(a,this.columnsArr[b].clientHeight),c=b);return c}},arangeItemToColum:{value:function(a){var c=a.view;this.columnsArr[this.getColumWithMinHeight()].appendChild(c);
a.display="block"}},addItemToStage:{value:function(a){this.arangeItemToColum(a);this.presentedList.push(a)}},itemWidth:{get:function(){var a=Math.floor(this.content.clientWidth/e(this.appName).collectionThumbRecomendedWidth);return this.content.clientWidth/a}}});p.prototype.constructor=p;v.prototype={externalScriptsReady:function(a){"function"===typeof window.codeasily_v2_itemMenu&&(this.itemMenuConstructor=window.codeasily_v2_itemMenu);"function"===typeof window.codeasily_v2_slider&&(this.sliderConstructor=
window.codeasily_v2_slider);"function"===typeof window.codeasily_v2_modalWin&&(this.modalWinConstructor=window.codeasily_v2_modalWin);e(this.appName).appEventManager.removeGMEventListener(l.EXT_SCRIPTS_READY,this,"externalScriptsReady");this.startApp()},startApp:function(){var a=this;e(this.appName).appEventManager.addGMEventListener(l.NEED_NEW_COLLECTION,this,"pushNewCollectionByTermID");e(this.appName).appEventManager.addGMEventListener(l.NEED_NEW_COLLECTION_BY_TERM,this,"pushNewCollectionByTerm");
e(this.appName).appEventManager.addGMEventListener(l.NEED_MODAL,this,"createModal");e(this.appName).lightBoxEnable&&(e(this.appName).appEventManager.addGMEventListener(l.NEED_LIGHTBOX,this,"createLightbox"),e(this.appName).appEventManager.addGMEventListener(l.REMOVE_LIGHTBOX,this,"removeLightbox"));this.viewsSet={};e(this.appName).appEventManager.addGMEventListener(l.COUNTERS_UPDATED,this,"itemsCountersUpdateHandler");this.likesSet={};window.localStorage.getItem("gm_likesSet")&&(this.likesSet=JSON.parse(window.localStorage.getItem("gm_likesSet")));
window.addEventListener("resize",function(){a.windowResizeHandler(a)});this.popstateHandler=function(c){a.slider?a.slider.prepareToRemove():0<a.collections.length&&a.collections[a.collections.length-1]&&a.itemFromHash&&a.collections[a.collections.length-1].tryOpenLightboxForID(a.itemFromHash)};window.addEventListener("popstate",this.popstateHandler,!1);this.itemFromHash&&(this.startItem=this.itemFromHash,window.history.replaceState(null,null,window.location.pathname+window.location.search));this.appQuery&&
(this.createAudioPlayer(),this.collections[0].startRequest(this.appQuery))},get itemFromHash(){var a=window.location.hash.indexOf(this.appName),c=void 0;a+1&&(c=2<=window.location.hash.substr(a).split("-").length?parseInt(window.location.hash.substr(a).split("-")[1]):void 0);return c},itemHash:function(a){return"#"+this.appName+"-"+a.ID},addCollectioByQuery:function(a){var c=0;this.modal&&(this.modal.prepareToRemove(),c=500);this.slider&&(this.slider.prepareToRemove(),c=500);if(0<this.collections.length&&
this.collections[this.collections.length-1]){var b=this.collections[this.collections.length-1];b.deactivate();b.view.parentNode&&this.appDiv.removeChild(b.view)}document.body.scrollTop>this.appDiv.getBoundingClientRect().top&&(b=document.body.getBoundingClientRect(),b=this.appDiv.getBoundingClientRect().top-b.top-(k.is_touch_device?0:50),scrollToY(b,500));var d=this;!a.s&&this.searchForm&&this.searchForm.clear();setTimeout(function(){var b=new p(d,d.appName,a);d.collections.push(b);d.appDiv.appendChild(b.view);
b.init()},c)},pushNewCollectionByTerm:function(a){if(a.params||a.params.term)a=a.params.term,a.sharelink&&window.open(a.sharelink,"_self")},termLinkForTerm:function(a,c){return e(this.appName).post_url+"/?"+e(this.appName).galleryID+"["+c+"]="+a},pushNewCollectionByTermID:function(a){if(a.params||a.params.term_id||!a.params.taxonomy)a=this.termLinkForTerm(a.params.term_id,a.params.taxonomy),window.open(a,"_self")},set likeItem(a){a&&(a.meta.likes||(a.meta.likes=0),a.meta.likes=parseInt(a.meta.likes)+
1,a.view&&a.view.like&&(a.view.like=!0),a=a.ID,this.likesSet[a]||(this.likesSet[a]="like",this.viewsSet[a]&&delete this.viewsSet[a],a=JSON.stringify({counter:{likes:[a],views:[a]}}),k.request(a,this,l.COUNTERS_UPDATED),window.localStorage.setItem("gm_likesSet",JSON.stringify(this.likesSet))))},set viewItem(a){var c=a.ID;this.updateItemLink(a);this.viewsSet[c]="view"},itemsCountersUpdate:function(){if(this.viewsSet){var a=[];for(key in this.viewsSet)a.push(key);0<a.length&&(a=JSON.stringify({counter:{likes:[],
views:a}}),k.request(a,this,l.COUNTERS_UPDATED),this.viewsSet={})}},itemsCountersUpdateHandler:function(a){window.localStorage.setItem("gm_likesSet",JSON.stringify(this.likesSet))},createLightbox:function(a){if(a.params||a.params.collection){var c=a.params.collection;a=a.params.index;var b=c.filteredCollection[a];this.slider&&this.slider.prepareToRemove();window.localStorage.getItem("gm_likesSet")&&(this.likesSet=JSON.parse(window.localStorage.getItem("gm_likesSet")));this.sliderConstructor&&(this.slider=
this.sliderConstructor(this,k),this.slider.initByList(c.filteredCollection,a));c=this.itemHash(b);window.location.hash!=c&&window.history.pushState(null,null,c)}},updateItemLink:function(a){window.history.replaceState(null,null,this.itemHash(a))},removeLightbox:function(a){var c=this,b=a.target;setTimeout(function(){b.view&&b.view.parentNode&&b.view.parentNode.removeChild(b.view);c.slider&&(c.slider=void 0)},400);this.itemFromHash&&window.history.back()},createModal:function(a){if(a.params.type&&
a.params.item){var c=a.params.item,b=void 0;this.modal||(this.modal=this.modalWinConstructor(this,k));this.modal.type=a.params.type;switch(a.params.type){case "share":b=this.modal.shareBar;break;case "info":b=this.modal.infoBar}b.item=c;this.modal.pushPage(b.view)}},deleteModal:function(){this.modal&&delete this.modal},windowResizeHandler:function(a){this.bookmarkBox&&this.collectionTranslateY!=this.bookmarkBox.height&&(this.collectionTranslateY=this.bookmarkBox.height,this.showBookmarkInfo(this.bookmarkStatusShow));
0<this.collections.length&&this.collections[this.collections.length-1].resize();this.slider&&this.slider.resizeHandler()},createAudioPlayer:function(){var a=this;var c=document.getElementById("gmAudioPlayer")?document.getElementById("gmAudioPlayer"):new Audio;if(null!=c&&c.canPlayType&&c.canPlayType("audio/mpeg")){var b=function(b){a.slider&&a.slider.audioPlayerHandler(b)};c.id="gmAudioPlayer";c.setAttribute("type","audio/mpeg");c.setAttribute("codecs","mp3");this.audioPlayer=c;this.appDiv.appendChild(this.audioPlayer);
c.addEventListener("ended",b,!1);c.addEventListener("pause",b,!1);c.addEventListener("play",b,!1);c.addEventListener("durationchange",b,!1)}}};(function(){for(var a=document.body.getElementsByClassName("amron_module"),c=0;c<a.length;c++){var b=a[c].id;this[b]=new v(this[b],b,a[c])}})()}amron_module();
